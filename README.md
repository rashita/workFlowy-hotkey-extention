# 🚀 WorkFlowy Custom Shortcuts for Firefox

この拡張機能は、WorkFlowyでカスタムの複雑な操作をシンプルなショートカットキーで実行可能にし、日々のタスク管理の効率を向上させます。

---

## 🌟 機能 (Features)

WorkFlowyの操作を効率化するために以下のカスタム機能を提供します。

* **⚡️ 新しい親項目作成と移動機能:**
    * 選択された一つまたは複数のアイテムを囲むように、その直前に空の新しい親項目を作成します。
    * 選択されたアイテム群は、直ちに新しい親項目の子要素として移動します。
    * 処理後、カーソルは新しい親項目の先頭に移動し、即座に名前の編集を開始できます。
* **↩️ 特定の親子移動と展開/折りたたみ:**
    * WorkFlowyのネイティブAPIを使用した複雑な操作（展開・折りたたみ、親アイテムへのズームアウト等）を自動実行します。

---

## 💻 インストール方法 (Installation)

署名済みのアドオンファイル（`.xpi`）を使用して、簡単にインストールできます。

### 📦 一般ユーザー向け: 署名済みファイルからインストール（推奨）

この方法でインストールすると、ブラウザを再起動しても拡張機能が保持されます。

1.  **ファイルをダウンロード:**
    * 本リポジトリにアップロードされている `[ファイル名].xpi` をダウンロードします。
2.  **Firefoxのアドオン管理画面を開く:**
    * Firefoxのアドレスバーに `about:addons` と入力するか、メニューから「アドオンとテーマ」を選択します。
3.  **ファイルをインストール:**
    * ダウンロードした `.xpi` ファイルをアドオン管理画面に**ドラッグ＆ドロップ**します。
    * または、画面上の歯車アイコンをクリックし、「**ファイルからアドオンをインストール...**」を選択してダウンロードしたファイルを選びます。
4.  **権限の確認:**
    * インストールの確認ダイアログが表示されるので、「追加」をクリックします。

### 🛠️ 開発者向け: 一時的なアドオンとして読み込む

ソースコードを直接編集してテストしたい場合の方法です。

1.  Firefoxで `about:debugging` を開く。
2.  「この Firefox」を選択し、「一時的なアドオンを読み込む...」をクリック。
3.  `manifest.json` を含むディレクトリ、または作成したZIPファイルを選択。
    * *※この方法ではブラウザの再起動後にアドオンが削除されます。*

---

## ⌨️ ショートカットキー一覧 (Keyboard Shortcuts)

| 操作内容 (Action) | ショートカットキー (Key Combination) |
| :--- | :--- |
| **新しい親項目を作成し、選択項目を移動する** | **`Alt` + `Command` + `[`** |
| アイテムの展開/折りたたみ、親への移動 | `Command` + `→` (ArrowRight) |
| 選択項目を親のトップに移動し、隣接項目を編集 | `Alt` + `Command` + `↑` (ArrowUp) |

### ⚠️ 環境による違い
* **Mac:** `Command` キーが有効です。
* **Windows/Linux:** `Command` の代わりに `Ctrl` キーを使用する場合は、`workflowy-hook.js` 内の判定条件を修正してください。
* **JISキーボード:** `Alt` + `Command` + `[` の組み合わせが、環境により別のキー（`‘` など）として認識される場合があります。その際は `console.log` で取得したキー名に合わせてコードを調整してください。

---

## 🔨 技術的な詳細 (Technical Details)

本拡張機能は、Content Scriptの制約を回避し、WorkFlowyが提供するグローバルオブジェクト (`WF`) にアクセスするために **Web Accessible Resources** を採用しています。

* `content.js`: 拡張機能スコープで動作。`workflowy-hook.js` をDOMに挿入し、Webページ側のスコープへ橋渡しをします。
* `workflowy-hook.js`: WorkFlowyのグローバルスコープで実行。`WF.focusedItem()`, `WF.moveItems()` 等の API を直接叩き、正確なDOM操作とカーソル制御を実現します。

---

## 📄 ライセンス (License)

[MIT License]